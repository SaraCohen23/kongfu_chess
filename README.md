# Chess Game - Client/Server Architecture

המשחק הוסב לעבוד עם ארכיטקטורה של קליינט-סרבר, כך ששני שחקנים יכולים לשחק ביחד ממחשבים שונים או מטרמינלים שונים.

## מבנה הפתרון

### קבצים חדשים:
- `server.py` - השרת המרכזי שמנהל את המשחק
- `client.py` - הלקוח שמתחבר לשרת  
- `server_game.py` - לוגיקת המשחק בצד השרת (ללא גרפיקה)
- `run.py` - סקריפט הפעלה מהיר
- `requirements.txt` - חבילות הנדרשות

### התלות:
- `websockets` - תקשורת בין קליינט לשרת
- `keyboard` - טיפול בקלט מקלדת
- `opencv-python` + `numpy` - עבור הגרפיקה הקיימת

## איך להפעיל

### 1. התקנת חבילות:
```bash
pip install -r requirements.txt
```

או:
```bash
python run.py install
```

### 2. הפעלת השרת:
```bash
python run.py server
```

או ישירות:
```bash
python server.py
```

השרת ירוץ על `localhost:8765` ויחכה לשני לקוחות.

### 3. הפעלת לקוחות:

**טרמינל 2 (שחקן 1 - עם גרפיקה):**
```bash
python run.py client
```

**טרמינל 3 (שחקן 2 - עם גרפיקה):**
```bash
python run.py client
```

**לחילופין - לקוח במסוף (ללא גרפיקה):**
```bash
python run.py console
```

## איך זה עובד

### השרת:
1. מחכה לחיבור של שני שחקנים
2. מאתחל משחק חדש כשמתחברים שני שחקנים
3. מקבל פקודות מהלקוחות ומבדק חוקיותן
4. שולח עדכונים לשני הלקוחות על מצב הלוח

### הלקוח:
1. מתחבר לשרת דרך WebSocket
2. **מציג את הלוח הגרפי המלא** (כמו במשחק המקורי)
3. מקבל קלט מהמשתמש (חיצים + Enter)
4. שולח פקודות לשרת ומעדכן התצוגה

### סוגי לקוחות:
- **`python run.py client`** - לקוח עם גרפיקה מלאה
- **`python run.py console`** - לקוח פשוט במסוף (טקסט בלבד)

## בקרות

### שחקן 1 (לבן):
- **חיצים**: ניווט על הלוח
- **Enter**: בחירת כלי / ביצוע מהלך
- **ESC**: יציאה

### שחקן 2 (שחור):
- **WASD**: ניווט על הלוח
- **F**: בחירת כלי / ביצוע מהלך
- **ESC**: יציאה

## התצוגה

### לקוח גרפי (`python run.py client`):
- **לוח שח מלא וגרפי** (כמו במשחק המקורי)
- **כלי שח אמיתיים** עם אנימציות
- **רקע יפה** ועיצוב מקצועי
- סמן ירוק לבחירת מיקום
- סימון צהוב לכלי שנבחר

### לקוח מסוף (`python run.py console`):
- לוח שח פשוט במסוף (טקסט)
- מיקום הסמן הנוכחי `[]`
- כלי נבחר `*כלי*`
- מידע על תור השחקן ומצב המשחק

## שינויים מהקוד המקורי

1. **הפרדת לוגיקה**: הלוגיקה של המשחק הועברה ל-`ServerGame` ללא גרפיקה
2. **תקשורת רשת**: נוספה תקשורת WebSocket בין קליינט לשרת
3. **ממשק פשוט**: הלקוח מציג לוח פשוט במסוף במקום הגרפיקה המלאה
4. **מצב משחק מרכזי**: השרת שומר על מצב המשחק האמיתי

## הרחבות אפשריות

- [ ] הוספת גרפיקה מלאה ללקוח
- [ ] בדיקת חוקיות מהלכים מתקדמת יותר
- [ ] זיהוי מצבי שח/מט
- [ ] שמירה וטעינה של משחקים
- [ ] תמיכה ביותר משני שחקנים (משחקים מרובים)
- [ ] ממשק ווב במקום מסוף

## בעיות נפוצות

1. **שרת לא מתחיל**: בדוק שהפורט 8765 פנוי
2. **לקוח לא מתחבר**: בדוק שהשרת רץ ופעיל
3. **בעיות קלט**: בדוק שהחבילה `keyboard` מותקנת עם הרשאות מתאימות

## מבנה ההודעות

### לקוח ← שרת:
```json
{
  "type": "move",
  "piece_id": "PW1",
  "from": [6, 0],
  "to": [4, 0]
}
```

### שרת → לקוח:
```json
{
  "type": "game_state",
  "state": {
    "pieces": [...],
    "current_turn": "white",
    "game_status": "playing"
  }
}
```
